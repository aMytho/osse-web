<div class="px-4 pb-1">
  <div class="min-h-14 h-full w-full flex gap-x-4">
    <div class="w-full flex lg:justify-between md:gap-x-8 gap-x-4 items-center">
      <div class="flex gap-x-4 items-center basis-1/4">
        <a class="bg-slate-300 rounded-md backdrop-blur-sm w-14 h-14 p-2 inline-block bg-cover drop-shadow-glow max-md:hidden"
          style="background-image: url('{{bg()}}');" routerLink="/"></a>
        <div class="grow shrink">
          <div id="track-title-container"
            class="w-full relative whitespace-nowrap overflow-hidden font-semibold text-lg">
            <p class="whitespace-nowrap w-min overflow-hidden overflow-ellipsis" #trackTitleElement>
              {{trackTitle()}}
            </p>
          </div>
          <p class="italic whitespace-nowrap overflow-hidden overflow-ellipsis">{{artistTitle()}}</p>
        </div>
      </div>
      <div class="lg:basis-1/4 basis-3/4 max-sm:hidden">
        <app-track-controls></app-track-controls>
      </div>
      <div class="sm:hidden">
        <app-play-pause></app-play-pause>
      </div>
      <div class="basis-1/4 flex gap-x-4 max-lg:hidden">
        <p>{{ currentTime() || '0:00' }}</p>
        <div class="w-full flex flex-col items-center justify-around gap-y-1"
          [ngClass]="{'pointer-events-none': !playerService.isPlaying()}">
          <div #progressContainer id="progressContainer" (mousedown)="onSetPosition($event)"
            class="relative w-full z-10 h-2 flex items-center bg-slate-700 bg-opacity-40 cursor-pointer">
            <div #rendered id="rendered" class="absolute w-full h-2 rounded-l-lg rounded-r-lg"></div>
            <!-- <div id="loaded" class="bg-emerald-300 h-2 rounded-l-lg"></div> -->
            <div #point id="point" class="absolute w-4 h-4 rounded-lg bg-cyan-300 hover:bg-cyan-400 -ml-2 z-20"
              (mousedown)="onMouseDown($event)" (drag)="onMouseMove($event)"></div>
          </div>
        </div>
        <p>{{ totalDuration() || '0:00' }}</p>
      </div>
    </div>
    <div class="w-min flex items-center">
      <button (click)="togglePopover()" class="rounded-full px-2 py-1 hover:bg-emerald-300 hover:bg-opacity-15"
        title="Toggle advanced controls">
        <app-icon [icon]="verticalDots"></app-icon>
      </button>
    </div>
  </div>
  @if (showPopoverControls()) {
  <div class="absolute bottom-20 w-full pr-16">
    <app-popover-controls (onClose)="showPopoverControls.set(false)"></app-popover-controls>
  </div>
  }
</div>
